Алгоритм состоит в следующем:
Будем хранить на стеке парсинга пару:
1. Сет из пар - длина префикса слова из х и длина самого слова 
2. Минимальная длина слова
3. Сам ответ на задачу
Соответственно эти величины пересчитываются используя друг друга.
