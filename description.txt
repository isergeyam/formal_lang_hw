Алгоритм состоит в следующем:
Будем хранить на стеке парсинга пару:
1. Сет из пар - длина хорошего префикса  из языка и длина самого слова для всех хороших слов из языка
2. Минимальная длина слова из языка
3. Сам ответ на задачу
Соответственно, эти величины пересчитываются используя друг друга.
